<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <title>Keykes Admin Dashboard</title>

    <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon" />

    <link href="css/bootstrap.css?v=1.1" rel="stylesheet" type="text/css" />

    <!-- custom style -->
    <link href="css/ui.css?v=1.1" rel="stylesheet" type="text/css" />
    <link href="css/responsive.css?v=1.1" rel="stylesheet" />

    <!-- iconfont -->
    <link rel="stylesheet" href="fonts/material-icon/css/round.css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"></script>

    <script type="text/javascript">
      function handlePop(id, tag) {
        localStorage.setItem("id", id);
      }
      function handleLogout() {
        localStorage.removeItem("token");
      }

      function handleRequest() {
        var token = localStorage.getItem("token");
        if (!token) {
          window.location.replace("https://keykesadmin.netlify.app/index.html");
        } else {
          axios
            .get("https://www.keykes.com/api/ticket/fetch/open/tickets", {
              headers: {
                "x-access-token": localStorage.getItem("token"),
              },
            })
            .then(function (response) {
              const products = response.data.data;
              var article = document.querySelector("tbody");
              for (let i = 0; i < products.length; i++) {
                var content = `
          
          <tr>
            <th scope="row">${products[i].updatedAt}</th>
            <td>${products[i].issuedBy}</td>
            <td>${products[i].issue}</td>
            <td>${products[i].productName}</td>
           
            <td>${products[i].status == 1 ? "Open" : "Resolved"}</td>
            <td>
           <a href="singleTicket.html?id=${
             products[i]._id
           }"  <button id="id" type="button" class="btn-btn-bg-blue" value=${
                  products[i]._id
                } onclick = "handleStatus()" > Detail </button> </td>

           

          </tr>
   
   `;
                article.innerHTML += content;
              }
            });
        }
      }

      function handleStatus() {
        var id = document.getElementById("id").value;
        console.log(id);
      }
    </script>
  </head>

  <body onload="handleRequest()">
    <b class="screen-overlay"></b>

    <aside class="navbar-aside" id="offcanvas_aside">
      <div class="aside-top">
        <a href="page-index-1.html" class="brand-wrap">
          <img
            src="images/logo.svg"
            height="46"
            class="logo"
            alt="Ecommerce dashboard template"
          />
        </a>
        <div>
          <button class="btn btn-icon btn-aside-minimize">
            <i class="text-muted material-icons md-menu_open"></i>
          </button>
        </div>
      </div>
      <!-- aside-top.// -->

      <nav>
        <ul class="menu-aside">
          <li class="menu-item active">
            <a class="menu-link" href="page-index-1.html">
              <i class="icon material-icons md-home"></i>
              <span class="text">Dashboard</span>
            </a>
          </li>
          <li class="menu-item has-submenu">
            <a class="menu-link" href="page-products-list.html">
              <i class="icon material-icons md-shopping_bag"></i>
              <span class="text">Products</span>
            </a>
            <div class="submenu">
              <a href="page-products-list.html">Product list view</a>
              <!-- <a href="page-products-table.html">Product table view</a>
          <a href="page-products-grid.html">Product grid</a>
          <a href="page-products-grid-2.html">Product grid 2</a> -->
            </div>
          </li>

          <li class="menu-item has-submenu">
            <a class="menu-link" href="page-form-product-1.html">
              <i class="icon material-icons md-add_box"></i>
              <span class="text">Add product</span>
            </a>
            <div class="submenu">
              <a href="page-form-product-1.html">Add product 1</a>
              <!-- <a href="page-form-product-2.html">Add product 2</a>
          <a href="page-form-product-3.html">Add product 3</a>
          <a href="page-form-product-4.html">Add product 4</a>   -->
            </div>
          </li>
          <li class="menu-item has-submenu">
            <a class="menu-link" href="page-transactions-A.html">
              <i class="icon material-icons md-monetization_on"></i>
              <span class="text">Transactions</span>
            </a>
            <div class="submenu">
              <a href="page-transactions-A.html">Stripe Transaction</a>
              <a href="page-transactions-B.html">Paypal Transaction</a>
              <!-- <a href="page-transactions-B.html">Transaction 2</a> -->
            </div>
          </li>
          <li class="menu-item has-submenu">
            <a class="menu-link" href="discount.html">
              <i class="icon material-icons md-monetization_on"></i>
              <span class="text">Discount</span>
            </a>
            <div class="submenu">
              <a href="discount.html">Discount 1</a>
              <!-- <a href="page-transactions-B.html">Transaction 2</a> -->
            </div>
          </li>
          <li class="menu-item has-submenu">
            <a class="menu-link" href="#">
              <i class="icon material-icons md-person"></i>
              <span class="text">Tickets</span>
            </a>
            <div class="submenu">
              <a href="ticket.html">Tickets</a>
            </div>
          </li>
          <!-- <li class="menu-item"> 
        <a class="menu-link" href="page-reviews.html"> <i class="icon material-icons md-comment"></i> 
          <span class="text">Reviews</span> 
        </a> 
      </li>
      <li class="menu-item"> 
        <a class="menu-link" href="page-brands.html"> <i class="icon material-icons md-stars"></i> 
          <span class="text">Brands</span> </a> 
      </li>
      <li class="menu-item"> 
        <a class="menu-link" disabled href="#"> <i class="icon material-icons md-pie_chart"></i> 
          <span class="text">Statistics</span> 
        </a> 
      </li>
    </ul>
    <hr>
    <ul class="menu-aside">
      <li class="menu-item has-submenu"> 
        <a class="menu-link" href="#"> <i class="icon material-icons md-settings"></i> 
          <span class="text">Settings</span> 
        </a>
        <div class="submenu">
          <a href="page-settings-1.html">Setting sample 1</a>
          <a href="page-settings-2.html">Setting sample 2</a>
        </div>
      </li>
      <li class="menu-item">
        <a class="menu-link" href="page-0-blank.html"> <i class="icon material-icons md-local_offer"></i> 
          <span class="text"> Starter page </span>
        </a> 
      </li> -->
        </ul>
        <br />
        <br />
      </nav>
    </aside>

    <div id="product"></div>

    <main class="main-wrap">
      <header class="main-header navbar">
        <div class="col-nav">
          <button
            class="btn btn-icon btn-mobile me-auto"
            data-trigger="#offcanvas_aside"
          >
            <i class="md-28 material-icons md-menu"></i>
          </button>
          <ul class="nav" style="margin-left: 55vw">
            <li class="nav-item">
              <a
                class="nav-link btn-icon"
                onclick="darkmode(this)"
                title="Dark mode"
                href="#"
              >
                <i class="material-icons md-nights_stay"></i>
              </a>
            </li>
            <!-- <li class="nav-item">
          <a class="nav-link btn-icon" href="#"> <i class="material-icons md-notifications_active"></i> </a>
        </li> -->
            <li class="nav-item">
              <a class="nav-link" href="#"> English </a>
            </li>
            <li class="dropdown nav-item">
              <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#">
                <img
                  class="img-xs rounded-circle"
                  src="images/people/avatar1.jpg"
                  alt="User"
              /></a>
              <div class="dropdown-menu dropdown-menu-end">
                <a
                  class="dropdown-item text-danger"
                  href="index.html"
                  onclick="handleLogout()"
                  >Logout</a
                >
              </div>
            </li>
          </ul>
        </div>
      </header>

      <section class="content-main">
        <div class="content-header">
          <h2 class="content-title">Ticket</h2>
        </div>
        <table class="table">
          <thead class="thead-dark">
            <tr>
              <th scope="col">S.no</th>
              <th scope="col">Issue By</th>
              <th scope="col">Issue</th>
              <th scope="col">Product Name</th>
              <th scope="col">Status</th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </section>
      <!-- content-main end// -->
    </main>

    <script>
      if (localStorage.getItem("darkmode")) {
        var body_el = document.body;
        body_el.className += "dark";
      }
    </script>

    <script src="js/jquery-3.5.0.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>

    <!-- Custom JS -->
    <script src="js/script.js?v=1.0"></script>
  </body>
</html>
